# Requirements Document

## Introduction

ポケポケトレードプラットフォームは、ユーザーが安心してカードをトレードできるウェブサイトです。ポケポケのユーザー ID を使用した簡単な登録、欲しいカードと出せるカードの管理、そして悪質なユーザーからプラットフォームを守るブラックリスト機能を提供します。

## Glossary

- **System**: ポケポケトレードプラットフォーム
- **User**: プラットフォームを利用してカードをトレードする人
- **Pokepoke User ID**: ポケポケゲームで使用されるユーザー識別子
- **User Card Collection**: ユーザーのプロフィールに紐づく、全体的な欲しいカードと出せるカードのリスト
- **Trade Offer**: ユーザーが作成する個別のトレード提案で、具体的な欲しいカードと出せるカードの組み合わせを指定したもの
- **Blacklist**: 悪質な行為を行ったユーザーのリスト
- **Administrator**: プラットフォームを管理し、ユーザーをブラックリストに追加できる権限を持つ人

## Requirements

### 要件 1

**ユーザーストーリー:** ユーザーとして、ポケポケユーザー ID を使ってプラットフォームに登録したい。そうすることで、他のユーザーとカードのトレードを始められる。

#### 受け入れ基準

1. WHEN ユーザーが有効なポケポケユーザー ID を提供する、THE System SHALL 新しいユーザーアカウントを作成する
2. WHEN ユーザーが既に登録済みのポケポケユーザー ID で登録を試みる、THE System SHALL 登録を拒否し適切なメッセージを表示する
3. WHEN ユーザーが登録を完了する、THE System SHALL ユーザーをプロフィールページにリダイレクトする
4. WHEN ユーザーが無効な形式のポケポケユーザー ID を提供する、THE System SHALL 登録を拒否しバリデーションエラーを表示する
5. WHEN ユーザーが BAN されたポケポケユーザー ID を提供する、THE System SHALL 登録を拒否し、エラーを表示する

### 要件 2

**ユーザーストーリー:** ユーザーとして、プロフィールに全体的な欲しいカードと出せるカードのコレクションを管理したい。そうすることで、トレード提案を作成する際に利用できる。

#### 受け入れ基準

1. WHEN ユーザーが欲しいカードコレクションにカードを追加する、THE System SHALL カード情報を保存しユーザーアカウントに関連付ける
2. WHEN ユーザーが出せるカードコレクションにカードを追加する、THE System SHALL カード情報を保存しユーザーアカウントに関連付ける
3. WHEN ユーザーがいずれかのコレクションからカードを削除する、THE System SHALL データ整合性を維持しながら関連付けを削除する
4. WHEN ユーザーが自分のカードコレクションを表示する、THE System SHALL 欲しいカードと出せるカードの両方のコレクションにあるすべてのカードを表示する
5. WHEN ユーザーがいずれかのコレクションのカード数量を更新する、THE System SHALL 保存されている数量値を更新する

### 要件 3

**ユーザーストーリー:** ユーザーとして、自分のカードコレクションから具体的なトレード提案を作成したい。そうすることで、他のユーザーに明確なトレード内容を提示できる。

#### 受け入れ基準

1. WHEN ユーザーがトレード提案を作成する、THE System SHALL 欲しいカードと出せるカードを指定できるようにする
2. WHEN ユーザーがトレード提案にカードを追加する、THE System SHALL ユーザーのカードコレクションから選択できるようにする
3. WHEN ユーザーがトレード提案を保存する、THE System SHALL トレード提案をユーザーアカウントに関連付けて保存する
4. WHEN ユーザーがトレード提案を削除する、THE System SHALL データ整合性を維持しながらトレード提案を削除する
5. WHEN ユーザーが自分のトレード提案を表示する、THE System SHALL すべてのアクティブなトレード提案を表示する

### 要件 4

**ユーザーストーリー:** ユーザーとして、他のユーザーが作成したトレード提案を検索したい。そうすることで、自分の条件に合うトレードパートナーを見つけられる。

#### 受け入れ基準

1. WHEN ユーザーが特定のカードを検索する、THE System SHALL そのカードを出せるカードとして含むすべてのトレード提案を返す
2. WHEN ユーザーが検索結果を表示する、THE System SHALL ブラックリストに登録されたユーザーのトレード提案を結果から除外する
3. WHEN ユーザーがトレード提案の詳細を表示する、THE System SHALL 欲しいカードと出せるカードの両方を表示する
4. WHEN 検索結果を表示する、THE System SHALL 各トレード提案の作成者のポケポケユーザー ID を表示する
5. WHEN ユーザーが他のユーザーのプロフィールを表示する、THE System SHALL そのユーザーのすべてのトレード提案を表示する

### 要件 5

**ユーザーストーリー:** 管理者として、悪質なユーザーをブラックリストに追加したい。そうすることで、プラットフォームを詐欺から守り、安全なトレード環境を維持できる。

#### 受け入れ基準

1. WHEN 管理者がユーザーをブラックリストに追加する、THE System SHALL ユーザーアカウントをブラックリスト登録済みとしてマークする
2. WHEN ブラックリスト登録されたユーザーがログインを試みる、THE System SHALL アクセスを拒否し BAN メッセージを表示する
3. WHEN 管理者がブラックリストを表示する、THE System SHALL すべてのブラックリスト登録ユーザーをポケポケユーザー ID と共に表示する
4. WHEN ユーザーがブラックリストに登録される、THE System SHALL そのユーザーのすべてのトレードリストを公開表示から削除する
5. WHEN 管理者がユーザーをブラックリストから削除する、THE System SHALL ユーザーのアクセスとトレードリストを復元する

### 要件 6

**ユーザーストーリー:** ユーザーとして、自分のプロフィールとカードコレクション、トレード提案を表示したい。そうすることで、自分の情報を管理できる。

#### 受け入れ基準

1. WHEN ユーザーが自分のプロフィールページにアクセスする、THE System SHALL ポケポケユーザー ID を表示する
2. WHEN ユーザーが自分のプロフィールを表示する、THE System SHALL すべてのカードを含む現在の欲しいカードコレクションを表示する
3. WHEN ユーザーが自分のプロフィールを表示する、THE System SHALL すべてのカードを含む現在の出せるカードコレクションを表示する
4. WHEN ユーザーが自分のプロフィールページにいる、THE System SHALL カードコレクションにカードを追加または削除するオプションを提供する
5. WHEN ユーザーが自分のプロフィールを表示する、THE System SHALL すべてのアクティブ・クローズしたトレード提案を表示する

### 要件 7

**ユーザーストーリー:** ユーザーとして、トレード提案に紐づいたチャットで潜在的なトレードパートナーと連絡したい。そうすることで、トレードの交渉と完了ができる。

#### 受け入れ基準

1. WHEN ユーザーがトレード提案の詳細を表示する、THE System SHALL そのトレード提案に紐づくチャット機能を提供する
2. WHEN ユーザーがトレード提案のチャットにメッセージを送信する、THE System SHALL メッセージをそのトレード提案に関連付けて保存する
3. WHEN ユーザーがトレード提案のチャットを表示する、THE System SHALL そのトレード提案に関連するすべてのメッセージを時系列で表示する
4. WHEN ブラックリスト登録されたユーザーがチャットでメッセージを送信しようとする、THE System SHALL メッセージ送信を防止する
5. WHEN トレード提案の作成者または興味を示したユーザーがチャットにアクセスする、THE System SHALL チャット履歴を表示する
